<div class="ygg-schedule-form">
  <form [formGroup]="formGroup">
    <mat-accordion>
      <mat-expansion-panel expanded>
        <mat-expansion-panel-header>
          <ygg-title-divider
            [style.color]="formGroup.get('dateRange').invalid ? 'red' : ''"
            >預計日期範圍＊</ygg-title-divider
          >
        </mat-expansion-panel-header>
        <div class="form-control">
          <ygg-date-range-picker
            formControlName="dateRange"
          ></ygg-date-range-picker>
          <mat-error *ngIf="isError('dateRange', 'required')"
            >請填日期範圍</mat-error
          >
        </div>
      </mat-expansion-panel>
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <ygg-title-divider
            [style.color]="
              formGroup.get('numParticipants').invalid ? 'red' : ''
            "
            >預計參加人數＊</ygg-title-divider
          >
        </mat-expansion-panel-header>
        <div class="form-control">
          <ygg-number-slider
            formControlName="numParticipants"
            icon="person"
          ></ygg-number-slider>
        </div>
      </mat-expansion-panel>
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <ygg-title-divider>預算</ygg-title-divider>
        </mat-expansion-panel-header>
        <div class="form-control">
          <mat-radio-group
            [(ngModel)]="budgetType"
            [ngModelOptions]="{ standalone: true }"
          >
            <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="20px">
              <mat-radio-button [value]="'total'">總和</mat-radio-button>
              <mat-radio-button [value]="'single'">單人</mat-radio-button>
            </div>
          </mat-radio-group>
          <br />
          <div>
            <div *ngIf="budgetType === 'total'">
              <ygg-number-range-control
                formControlName="totalBudget"
                [globalMax]="100000"
                icon="monetization_on"
              ></ygg-number-range-control>
            </div>
            <div *ngIf="budgetType === 'single'">
              <ygg-number-range-control
                formControlName="singleBudget"
                [globalMax]="10000"
                icon="monetization_on"
              ></ygg-number-range-control>
            </div>
          </div>
        </div>
      </mat-expansion-panel>
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <ygg-title-divider>公司行號或團體名稱</ygg-title-divider>
        </mat-expansion-panel-header>
        <div class="form-control">
          <mat-form-field style="width:100%;">
            <input
              matInput
              placeholder="公司行號或團體名稱"
              formControlName="groupName"
            />
            <span matPrefix><mat-icon>group</mat-icon></span>
          </mat-form-field>
        </div>
      </mat-expansion-panel>
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <ygg-title-divider>聯絡人</ygg-title-divider>
        </mat-expansion-panel-header>
        <div formArrayName="contacts" class="form-control">
          <div
            *ngFor="
              let contactControl of contactsFormArray.controls;
              let idx = index
            "
          >
            <div
              fxLayout="row"
              fxLayoutAlign="space-between end"
              fxLayoutGap="20px"
            >
              <h4>聯絡人{{ idx + 1 }}</h4>
              <button
                mat-mini-fab
                (click)="deleteContact(idx)"
                matTooltip="刪除聯絡人"
              >
                <mat-icon>delete</mat-icon>
              </button>
            </div>
            <ygg-contact-form [formControlName]="idx"></ygg-contact-form>
            <mat-divider> </mat-divider>
          </div>
          <br />
          <div fxLayout="row" fxLayoutAlign="end center" fxLayoutGap="20px">
            <button
              mat-mini-fab
              (click)="addContact()"
              matTooltip="增加一位聯絡人"
            >
              <mat-icon>add</mat-icon>
            </button>
          </div>
        </div>
      </mat-expansion-panel>
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <ygg-title-divider>交通工具</ygg-title-divider>
        </mat-expansion-panel-header>
        <div class="form-control">
          <mat-radio-group formControlName="transpotation">
            <div
              fxLayout="row"
              fxLayoutAlign="space-around center"
              fxLayoutGap="20px"
            >
              <mat-radio-button [value]="'bus'">遊覽車</mat-radio-button>
              <mat-radio-button [value]="'car'">自行開車</mat-radio-button>
            </div>
          </mat-radio-group>
          <br />
          <mat-form-field style="width:100%;">
            <input
              matInput
              placeholder="其他"
              formControlName="transpotation"
            />
          </mat-form-field>
        </div>
      </mat-expansion-panel>
    </mat-accordion>
  </form>
  <div class="debug">
    <pre>{{ formGroup.value | json }}</pre>
  </div>
</div>
