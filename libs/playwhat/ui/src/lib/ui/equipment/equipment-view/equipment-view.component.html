<div class="equipment-view" *ngIf="theThing">
  <div
    fxLayout="row"
    fxLayoutAlign="space-between center"
    fxLayoutGap="30px"
    [formGroup]="formGroup"
  >
    <ygg-omni-type-view-control
      class="name"
      formControlName="name"
      type="text"
      [editable]="!readonly"
      [viewStyle]="nameStyle"
    >
      <div errors>
        <div *ngIf="formGroup.get('name').errors?.required">
          請填入設備名稱
        </div>
      </div>
    </ygg-omni-type-view-control>
    <div fxLayout="row" fxLayoutAlign="end center" fxLayoutGap="20px">
      <div *ngIf="!readonly">
        <button
          type="button"
          mat-fab
          class="save edit"
          matTooltip="儲存設備"
          [disabled]="!isThingValid()"
          (click)="save()"
        >
          <mat-icon>save</mat-icon>
        </button>
      </div>
    </div>
  </div>
  <div [formGroup]="formGroupCells">
    <div *ngFor="let cellName of orderedCellNames">
      <div [attr.cell-name]="cellName" [hidden]="!isCellControlShown(cellName)">
        <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="20px">
          <ygg-title-divider [level]="4">{{ cellName }}</ygg-title-divider>
          <div *ngIf="!isCellRequired(cellName)">
            <button
              type="button"
              class="delete"
              mat-mini-fab
              [matTooltip]="'移除資料欄位 ' + cellName"
              (click)="deleteCell(cellName)"
            >
              <mat-icon>delete</mat-icon>
            </button>
          </div>
        </div>
        <the-thing-cell
          [formControlName]="cellName"
          [readonly]="readonly"
          [required]="isCellRequired(cellName)"
        ></the-thing-cell>
      </div>
    </div>
  </div>
  <br /><br />
  <div
    fxLayout="row"
    fxLayoutAlign="start center"
    fxLayoutGap="10px"
    *ngIf="!readonly && isThingValid()"
  >
    <h2>
      增加其他資料
    </h2>
    <div>
      <button
        type="button"
        mat-mini-fab
        class="add-cell edit"
        (click)="addCell()"
      >
        <mat-icon>add</mat-icon>
      </button>
    </div>
  </div>
</div>
