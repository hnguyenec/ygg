<div class="tour-plan-builder">
  <mat-horizontal-stepper linear #stepper>
    <mat-step [stepControl]="firstFormGroup">
      <div step="1" class="step1">
        <div
          fxLayout="row"
          fxLayoutAlign="space-between center"
          fxLayoutGap="10px"
        >
          <div>
            <h2>開始您的遊程規劃</h2>
          </div>
          <div>
            <button
              mat-fab
              class="next"
              matStepperNext
              [disabled]="firstFormGroup.invalid"
              matTooltip="下一步"
            >
              <mat-icon>navigate_next</mat-icon>
            </button>
          </div>
        </div>
        <form [formGroup]="firstFormGroup">
          <div
            fxLayout="row wrap"
            fxLayoutAlign="start start"
            fxLayoutGap="50px"
          >
            <div class="date-range">
              <ygg-date-range-control
                label="預計出遊日期"
                formControlName="dateRange"
              ></ygg-date-range-control>
              <br />
            </div>
            <div class="num-participants">
              <ygg-number-control
                label="預計參加人數"
                formControlName="numParticipants"
              ></ygg-number-control>
            </div>
          </div>
          <br />
          <div class="play-list">
            <h4>選擇想要參加的體驗</h4>
            <the-thing-finder
              [filter]="filterPlays"
              hideFilter
              (selectTheThing)='onSelectPlay($event)'
              (deselectTheThing)='onDeselectPlay($event)'
            ></the-thing-finder>
          </div>
        </form>
      </div>
    </mat-step>
    <mat-step [stepControl]="secondFormGroup">
      <div step="2" class="step2">
        <div
          fxLayout="row"
          fxLayoutAlign="space-between center"
          fxLayoutGap="10px"
        >
          <div>
            <button
              type="button"
              mat-fab
              class="previous"
              matStepperPrevious
              matTooltip="上一步"
            >
              <mat-icon>navigate_before</mat-icon>
            </button>
          </div>
          <div><h2>請留下您的聯絡資料</h2></div>
          <div>
            <button
              type="button"
              mat-fab
              class="next"
              matStepperNext
              [disabled]="secondFormGroup.invalid"
              (click)="updateTourPlan()"
              matTooltip="下一步"
            >
              <mat-icon>navigate_next</mat-icon>
            </button>
          </div>
        </div>
        <form [formGroup]="secondFormGroup">
          <br><br>
          <div class="contact-control">
            <ygg-contact-control
              formControlName="contact"
            ></ygg-contact-control>
          </div>
        </form>
      </div>
    </mat-step>
    <mat-step [stepControl]="thirdFormGroup">
      <div step="3" class="step3">
        <div
          fxLayout="row"
          fxLayoutAlign="space-between center"
          fxLayoutGap="10px"
        >
          <div>
            <button
              type="button"
              mat-fab
              class="previous"
              matStepperPrevious
              matTooltip="上一步"
            >
              <mat-icon>navigate_before</mat-icon>
            </button>
          </div>
          <div><h2>其他需求事項</h2></div>
          <div>
            <button
              type="button"
              mat-fab
              class="next"
              matStepperNext
              matTooltip="下一步"
            >
              <mat-icon>navigate_next</mat-icon>
            </button>
          </div>
        </div>
        <form [formGroup]="thirdFormGroup">
          <div class="optional-editor">
            <the-thing-cells-editor
              [formControl]="formControlOptionalCells"
            ></the-thing-cells-editor>
          </div>
        </form>
      </div>
    </mat-step>
    <mat-step>
      <div step="4" class="step4">
        <div
          fxLayout="row"
          fxLayoutAlign="space-between center"
          fxLayoutGap="10px"
        >
          <div>
            <button
              type="button"
              mat-fab
              class="previous"
              matStepperPrevious
              matTooltip="上一步"
            >
              <mat-icon>navigate_before</mat-icon>
            </button>
          </div>
          <div>
            <h2>
              體驗項目選單
            </h2>
          </div>
          <div>
            <button
              type="button"
              mat-fab
              class="next"
              matStepperNext
              matTooltip="下一步"
              (click)="toFinalStep()"
            >
              <mat-icon>navigate_next</mat-icon>
            </button>
          </div>
        </div>
        <div class='shopping-cart-editor'>
          <ygg-shopping-cart-editor [formControl]='formControlPurchases'></ygg-shopping-cart-editor>
        </div>
      </div>
    </mat-step>
    <mat-step>
      <div step="5" class="step5">
        <div
          fxLayout="row"
          fxLayoutAlign="space-between center"
          fxLayoutGap="10px"
        >
          <div>
            <button
              type="button"
              mat-fab
              class="previous"
              matStepperPrevious
              matTooltip="上一步"
            >
              <mat-icon>navigate_before</mat-icon>
            </button>
          </div>
          <div>
            <h2>
              預覽並送出遊程規劃
            </h2>
          </div>
          <div>
            <button
              type="button"
              mat-fab
              class="submit"
              matTooltip="送出遊程規劃"
              [disabled]="!isValidTourPlan()"
              (click)="submitTourPlan()"
            >
              <mat-icon>send</mat-icon>
            </button>
          </div>
        </div>
        <div>
          <ygg-tour-plan-view [theThing$]="tourPlan$"></ygg-tour-plan-view>
        </div>
      </div>
    </mat-step>
  </mat-horizontal-stepper>
</div>
